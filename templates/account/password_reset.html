{% extends "base.html" %}
{% load static i18n %}

{% block title %}{% trans "Recuperar contrase単a" %}{% endblock %}

{% block content %}
{% if form.errors %}
<section class="page-header" style="min-height: 120px;"></section>
<script>
(function() {
  function showResetModalWithErrors() {
    var errEl = document.getElementById("passwordResetModalErrors");
    var formEl = document.querySelector("#passwordResetModal form");
    if (!errEl || !formEl) return;
    var parts = [];
    {% for error in form.non_field_errors %}parts.push("{{ error|escapejs }}");{% endfor %}
    {% for field in form %}{% for error in field.errors %}parts.push("{{ error|escapejs }}");{% endfor %}{% endfor %}
    errEl.textContent = parts.length ? parts.join(" ") : "{% trans 'Revisa el correo e intenta de nuevo.' %}";
    errEl.style.display = "block";
    var emailInput = document.getElementById("modal_reset_email");
    if (emailInput) emailInput.value = "{{ form.email.value|default:''|escapejs }}";
    var modal = document.getElementById("passwordResetModal");
    if (modal && window.bootstrap) {
      var m = bootstrap.Modal.getOrCreateInstance(modal);
      m.show();
    }
    if (window.history && window.history.replaceState) {
      history.replaceState(null, "", "{% url 'core:home' %}");
    }
  }
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", showResetModalWithErrors);
  } else {
    showResetModalWithErrors();
  }
})();
</script>
{% else %}
<section class="page-header">
  <div class="page-header__bg" style="background-image: url({% static 'assets/images/backgrounds/page-header-bg.jpg' %});"></div>
  <div class="container">
    <h2 class="page-header__title">{% trans "Recuperar contrase単a" %}</h2>
    <ul class="boskery-breadcrumb list-unstyled">
      <li><a href="{% url 'core:home' %}">{% trans "Inicio" %}</a></li>
      <li><span>{% trans "Recuperar contrase単a" %}</span></li>
    </ul>
  </div>
</section>
<section class="section-space">
  <div class="container text-center">
    <p class="mb-3">{% trans "Te enviaremos un enlace a tu correo para restablecer tu contrase単a." %}</p>
    <a href="#" class="boskery-btn" data-bs-toggle="modal" data-bs-target="#passwordResetModal">{% trans "Abrir formulario" %}</a>
  </div>
</section>
{% endif %}
{% endblock %}
